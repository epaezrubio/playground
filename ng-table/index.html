<!DOCTYPE html>
<html>

  <head>
    <script src="http://code.angularjs.org/1.2.0-rc.3/angular.js"></script>
    <script src="http://code.angularjs.org/1.2.0-rc.3/angular-animate.js"></script>
    <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script> 
    <script src="ng-table.js"></script>
    
    <link rel="stylesheet" href="http://bazalt-cms.com/assets/ng-table/0.3.0/ng-table.css" />
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" />
    
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="animate.css" />
    <script src="script.js"></script>
  </head>

<body ng-app="main" ng-controller="DemoCtrl">
    <table class="table">
        <thead>
            <th></th>
            <th></th>
            <th><a href="#" ng-click="sorting = (sorting == 'title') ? '-title' : 'title'">Titel</a></th>
            <th><a href="#" ng-click="sorting = (sorting == 'assignedTo') ? '-assignedTo' : 'assignedTo'">Zugewiesen</a></th>
            <th><a href="#" ng-click="sorting = (sorting == 'status') ? '-status' : 'status'">Status</a></th>
            <th><a href="#" ng-click="sorting = (sorting == 'start') ? '-start' : 'start'">Start</a></th>
            <th><a href="#" ng-click="sorting = (sorting == 'end') ? '-end' : 'end'">Ende</a></th>
            <th><a href="#" ng-click="sorting = (sorting == 'time') ? '-time' : 'time'">Zeit</a></th>
            <th><a href="#" ng-click="sorting = (sorting == 'progress') ? '-progress' : 'progress'">Fortschritt</a></th>
        </thead>
        <tbody>
            <tr class="ng-table-group" ng-repeat-start="project in data | orderBy:sorting" ng-init="project.hideTasks = false"> 
                <td width="30">
                    <a ng-if="editId !== project.id" href="#" ng-click="delete(project)">
                        <span class="glyphicon glyphicon-remove"></span>
                    </a>
                    <a ng-if="editId === project.id" href="#" ng-click="cancelEdit(project)">
                        <span class="glyphicon glyphicon-ban-circle"></span>
                    </a>
                </td>
                <td width="30">
                    <a ng-if="editId === project.id" href="#" ng-click="edit({id: -1})">
                        <span class="glyphicon glyphicon-ok"></span>
                    </a>
                    <a ng-if="editId !== project.id" href="#" ng-click="edit(project)">
                        <span class="glyphicon glyphicon-pencil"></span>
                    </a>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <span class="glyphicon" ng-if="project.tasks.length > 0" ng-class="{ 'glyphicon-chevron-right': !project.hideTasks, 'glyphicon-chevron-down': project.hideTasks }"></span>
                            <strong>{{ project.title }}</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id">
                        <input type="text" ng-model="project.title" />
                    </div>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <strong>{{ project.assignedTo }}</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id">
                        <input type="text" ng-model="project.assignedTo" />
                    </div>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <strong>{{ project.status }}</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id" ng-init="states = ['Neu', 'Zugewiessen', 'Erledigt']">
                        <select ng-model="project.status" ng-options="status for status in states">
                    </div>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <strong>{{ project.start }}</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id">
                        <input type="text" ng-model="project.start" />
                    </div>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <strong>{{ project.end }}</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id">
                        <input type="text" ng-model="project.end" />
                    </div>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <strong>{{ project.time }}h</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id">
                        <input type="range" max="40" step="0.25" ng-model="project.time" /> {{ project.time | number:2 }}h
                    </div>
                </td>
                <td>
                    <div ng-show="editId !== project.id">
                        <a href="" ng-click="project.hideTasks = !project.hideTasks">
                            <strong>{{ project.progress }}%</strong>
                        </a>
                    </div>
                    <div ng-show="editId === project.id">
                        <input type="range" ng-model="project.progress" />
                    </div>
                </td>
            </tr>
            <tr ng-repeat="task in project.tasks | orderBy:sorting" ng-repeat-end ng-show="project.hideTasks">
                <td></td>
                <td></td>
                <td>{{ task.title }}</td>
                <td>{{ task.assignedTo }}</td>
                <td>{{ task.status }}</td>
                <td>{{ task.start }}</td>
                <td>{{ task.end }}</td>
                <td>{{ task.time }}h</td>
                <td>{{ task.progress }}</td> 
            </tr>
        </tbody>
    </table>
</body>
</html>
